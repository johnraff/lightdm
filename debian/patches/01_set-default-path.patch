Author: Yves-Alexis Perez <corsac@debian.org>
Author: Lionel Le Folgoc <mrpouit@gmail.com>
Bug: https://bugs.launchpad.net/ubuntu/+source/lightdm/+bug/798277
Description: Fix default PATH environment variable
Index: lightdm-1.1.4/src/seat.c
===================================================================
--- lightdm-1.1.4.orig/src/seat.c	2012-03-01 08:05:25.960438014 +0100
+++ lightdm-1.1.4/src/seat.c	2012-03-01 08:05:50.092580678 +0100
@@ -257,7 +257,10 @@
         process_set_env (script, "PATH", g_getenv ("PATH"));
     }
     else
-        process_set_env (script, "PATH", "/usr/local/bin:/usr/bin:/bin");
+        if (user_get_uid (user) == 0)
+          process_set_env (script, "PATH", "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin");
+        else
+          process_set_env (script, "PATH", "/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games");
 
     if (user)
     {
Index: lightdm-1.1.4/src/session-child.c
===================================================================
--- lightdm-1.1.4.orig/src/session-child.c	2012-03-01 08:05:25.984438155 +0100
+++ lightdm-1.1.4/src/session-child.c	2012-03-01 08:06:03.660660891 +0100
@@ -290,7 +290,10 @@
         else
         {
             /* Set POSIX variables */
-            pam_putenv (pam_handle, "PATH=/usr/local/bin:/usr/bin:/bin");
+            if (user_get_uid (user) == 0)
+              pam_putenv (pam_handle, "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin");
+            else
+              pam_putenv (pam_handle, "PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games");
             pam_putenv (pam_handle, g_strdup_printf ("USER=%s", username));
             pam_putenv (pam_handle, g_strdup_printf ("LOGNAME=%s", username));
             pam_putenv (pam_handle, g_strdup_printf ("HOME=%s", user_get_home_directory (user)));
